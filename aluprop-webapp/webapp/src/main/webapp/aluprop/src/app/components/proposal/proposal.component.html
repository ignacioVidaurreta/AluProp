<div *ngIf="proposal && currentUser" class="proposal-container">
  <mat-card class="proposal-card mat-elevation-z8">
    <img style="object-fit: cover;height: 25rem" [ngClass]="(proposal.state == 'DECLINED' || proposal.state == 'CANCELED' || proposal.state == 'DROPPED') ? 'grayscale' : ''" src="http://lisagryba.com/wp-content/uploads/2015/04/nice-houses-for-sale.jpg" mat-card-image alt="">
    <mat-card-header>
      <mat-card-subtitle translate>proposal.proposal</mat-card-subtitle>
      <mat-card-title><a [routerLink]="['/property/' + proposal.property.id]">{{ proposal.property.description }}</a></mat-card-title>
    </mat-card-header>
    <mat-card-content style="margin: 0 16px;">
      <div>
        <p>{{ proposal.property.caption }}</p>
      </div>
      <div>
        <app-proposal-users-table [proposalCreator]="proposal.creator" [proposalState]="proposal.state"></app-proposal-users-table>
      </div>
    </mat-card-content>
    <mat-card-content style="margin-top: 16px; text-align: center">
          <div *ngIf="proposal.state == 'DROPPED'">
             <div translate *ngIf="currentUser.role == 'ROLE_HOST'">
               proposal.declined-host
             </div>
           <div *ngIf="currentUser.role == 'ROLE_GUEST'">
             <span translate>proposal.dropped</span>
             <a translate>proposal.find-another-property</a>
           </div>
          </div>
          <div *ngIf="proposal.state == 'CANCELED'">
             <span translate>proposal.canceled</span><br/>
             <a [routerLink]="''" translate>proposal.find-another-property</a>
          </div>
          <div *ngIf="proposal.state == 'DECLINED'">
             <span translate>proposal.declined</span><br/>
             <a [routerLink]="''" translate>proposal.find-another-property</a>
          </div>
          <div *ngIf="proposal.state == 'ACCEPTED'">
             <div translate *ngIf="currentUser.role == 'ROLE_HOST'">
               proposal.accepted-host
             </div>
             <div *ngIf="currentUser.role == 'ROLE_GUEST'">
               <span translate>proposal.accepted</span><br/>
               <span><span translate>proposal.host-info</span> {{proposal.property.owner.name}} | {{proposal.property.owner.email}} | {{proposal.property.owner.contactNumber}}</span>
             </div>
          </div>
          <div translate *ngIf="proposal.state == 'SENT' && currentUser.role == 'ROLE_GUEST'">
            proposal.sent
          </div>
          <div *ngIf="proposal.state == 'SENT' && currentUser.role == 'ROLE_HOST'">
            <div  *ngIf="proposal.property.availability == 'RENTED' else active">
              <div translate>proposal.rented-host</div>
              <button disabled mat-button><span translate>proposal.decline</span></button>
              <button disabled mat-button><span translate>proposal.accept</span></button>
            </div>
            <ng-template #active>
              <div>
                <div translate>proposal.your-property</div>
                <button mat-button><span translate>proposal.decline</span></button>
                <button mat-button><span translate>proposal.accept</span></button>
              </div>
            </ng-template>
          </div>
          <div *ngIf="proposal.state == 'PENDING' && currentUser.id == proposal.creator.id">
            <button mat-button>proposal.cancel</button>
          </div>
          <div *ngIf="proposal.state == 'PENDING' && isInvited == true && hasReplied == false">
            <div><span translate>proposal.you-would-pay</span> <b> ${{budget}} </b> <span translate>proposal.per-month</span></div>
            <mat-card-actions>
             <button mat-button><span translate>proposal.decline</span></button>
             <button mat-button><span translate>proposal.accept</span></button>
            </mat-card-actions>
          </div>
          <div *ngIf="proposal.state == 'PENDING' && isInvited == true && hasReplied == true">
            <span translate>proposal.already-replied</span>
          </div>
    </mat-card-content>
  </mat-card>
</div>

